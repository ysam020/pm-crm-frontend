"use strict";(self.webpackChunkpaymaster_crm=self.webpackChunkpaymaster_crm||[]).push([[2935,2986],{2986:(e,o,a)=>{a.d(o,{getGeolocation:()=>t});const t=async e=>{try{if(!navigator.geolocation)return null;const e=await new Promise(((e,o)=>{navigator.geolocation.getCurrentPosition((o=>e(o)),(e=>o(e)),{timeout:3e4,maximumAge:0})}));return{latitude:e.coords.latitude,longitude:e.coords.longitude}}catch(o){let a;return a=1===o.code?"Location permission is denied. Please enable location access.":"User denied Geolocation"===o.message?"Location permission denied. Please enable location permission to log in.":o.message?o.message:"An unknown error occurred.",e({open:!0,message:a,severity:"error"}),console.error("Error fetching geolocation:",o),null}}},2935:(e,o,a)=>{a.d(o,{login:()=>s});var t=a(2986),n=a(3785);async function s(e,o,a,s){const r=await(0,t.getGeolocation)(s);try{const t=await n.A.post("/webauthn-login",{username:e,geolocation:r,userAgent:navigator.userAgent,credential:o});"Login successful"===t.data.message?a(t.data.user):s({open:!0,message:t.data.message,severity:"error"}),await n.A.post("/unusual-login-detection",{geolocation:r})}catch(i){s({open:!0,message:i.response.data.message,severity:"error"})}}}}]);