"use strict";(self.webpackChunkpaymaster_crm=self.webpackChunkpaymaster_crm||[]).push([[4137],{4137:(e,a,t)=>{t.d(a,{initiateWebauthnRegistration:()=>i});const r=e=>{const a=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(a),r=new Uint8Array(t.length);for(let s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r};var s=t(3785);const n=async(e,a)=>{try{(await s.A.post("/webauthn-verify-registration",{credential:e})).data.verified?a({open:!0,message:"Registration successful!",severity:"success"}):a({open:!0,message:"Registration failed. Please try again.",severity:"error"})}catch(t){a({open:!0,message:t.response.data.message,severity:"error"})}};async function i(e){try{const a=await(0,s.A)("/webauthn-register"),t=r(a.data.challenge),i=r(a.data.user.id),c={...a.data,challenge:t,user:{...a.data.user,id:i}},o=await navigator.credentials.create({publicKey:c});await n(o,e)}catch(a){console.error("Registration error:",a)}}}}]);