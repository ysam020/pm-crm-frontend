"use strict";(self.webpackChunkpaymaster_crm=self.webpackChunkpaymaster_crm||[]).push([[7343],{3557:(e,n,t)=>{t.d(n,{A:()=>m});var a=t(9950),r=t(9254),s=t(226),o=t(6639),i=t(5112),l=t(4414);const u={margin:0,width:20,height:20,marginRight:10,color:"#fff"};function c(e){const{theme:n}=a.useContext(i.D),t=(0,r.Ay)(s.A)({backgroundColor:"light"===n?"#111b21":"#0c3f61",color:"#fff",padding:"8px 20px",cursor:"pointer",boxShadow:"0 0 20px 1px rgba(0, 0, 0, 0.3)",borderRadius:"8px",marginTop:"10px",textTransform:"none",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"light"===n?"#111b21":"#0c3f61",boxShadow:"0 0 20px 1px rgba(0, 0, 0, 0.3)"}});return(0,l.jsx)(t,{startIcon:e.isSubmitting?(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)(o.A,{style:u}),children:(0,l.jsx)(o.A,{style:u})}):null,type:"submit",disableRipple:!0,variant:"contained",disabled:e.isSubmitting,children:e.name})}const m=a.memo(c)},7343:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var a=t(9950),r=t(6449),s=t(2436),o=t(3557),i=t(3939),l=t(9714);const u=l.Ik({username:l.Yj().required("Username is required").min(4,"Username should be at least 4 characters long")});var c=t(9845),m=t(4414);function d(e){const{setUser:n}=(0,a.useContext)(s.R),l=(0,a.useRef)(null),{setAlert:d}=(0,a.useContext)(c.C);(0,a.useEffect)((()=>{l.current&&l.current.focus()}),[]);const b=(0,i.Wx)({initialValues:{username:e.username},validationSchema:u,onSubmit:async a=>{let r;e.setUsername(a.username);try{const{checkCredentials:s}=await t.e(8786).then(t.bind(t,8786));if(r=await s(a.username),!r)return void d({open:!0,message:"User not found",severity:"error"});if(!r.hasCredentials)return e.setUseWebAuthn(!1),void e.setIsTwoFactorEnabled(r.isTwoFactorEnabled);const{getLoginOptions:o}=await t.e(8747).then(t.bind(t,8747)),i=await o(a.username);if(!i)return void e.setUseWebAuthn(!1);const{formatLoginOptions:l}=await t.e(9122).then(t.bind(t,9122)),u=l(i),{getCredential:c}=await t.e(3167).then(t.bind(t,3167)),m=await c(u),{serializeCredential:b}=await t.e(1953).then(t.bind(t,1953)),h=b(m),{verifyCredential:f}=await t.e(8680).then(t.bind(t,8680));if(await f(a.username,h)){const{login:e}=await t.e(2935).then(t.bind(t,2935));await e(a.username,h,n,d)}else e.setUseWebAuthn(!1)}catch(s){console.error(s),"NotAllowedError"===s.name?console.warn("User canceled the WebAuthn prompt."):console.error(s),r?e.setIsTwoFactorEnabled(r.isTwoFactorEnabled):(console.warn("Could not determine 2FA status, setting to false."),e.setIsTwoFactorEnabled(!1)),e.setUseWebAuthn(!1)}}});return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("form",{className:"login-form",onSubmit:b.handleSubmit,children:[(0,m.jsx)(r.S,{ref:l,id:"username",name:"username",placeholder:"Username",value:b.values.username,onChange:b.handleChange}),b.touched.username&&b.errors.username&&(0,m.jsx)("small",{className:"p-error",children:b.errors.username}),(0,m.jsx)("br",{}),(0,m.jsx)(o.A,{type:"submit",variant:"outlined",name:"Submit"})]})})}const b=a.memo(d)}}]);