"use strict";(self.webpackChunkpaymaster_crm=self.webpackChunkpaymaster_crm||[]).push([[92],{5975:(e,n,t)=>{t.d(n,{B:()=>i});var o=t(815),s=t(8312);const a=(0,o.Wp)({apiKey:"AIzaSyDTDvGXNnUuzR3cqjVc5ZLyHfNqhrA_q5w",authDomain:"wapp-c2920.firebaseapp.com",databaseURL:"https://wapp-c2920-default-rtdb.firebaseio.com",projectId:"wapp-c2920",storageBucket:"wapp-c2920.appspot.com",messagingSenderId:"173956484948",appId:"1:173956484948:web:3c7ea53f56301230aa82c1",measurementId:"G-VX01JD5DCY"}),i=(0,s.dG)(a)},6136:(e,n,t)=>{t.r(n),t.d(n,{default:()=>K});var o=t(9950),s=t(32),a=t(4489),i=t(3239),r=t(8429),l=t(3945),c=t(8060),d=t(5333),p=t(3212),h=t(4801),x=t(6387),u=t(2362),m=t(2917);const g=function(e){(0,o.useEffect)((()=>{document.title=(e.length>0?`(${e.length}) `:"")+" Paymaster Management Solution Ltd.",n(e.length>0)}),[e]);const n=e=>{const n=document.createElement("canvas"),t=document.createElement("img");t.src="/favicon.ico",t.onload=()=>{n.width=32,n.height=32;const o=n.getContext("2d");o.drawImage(t,0,0,32,32),e&&(o.fillStyle="#F15C6D",o.beginPath(),o.arc(26,6,6,0,2*Math.PI),o.fill());const s=n.toDataURL("image/png"),a=document.querySelector("link[rel='icon']")||document.createElement("link");a.rel="icon",a.href=s,document.head.appendChild(a)}}},b=(0,o.createContext)();var f=t(4414);function j(){const{notifications:e,loading:n}=(0,o.useContext)(b),s=(0,r.Zp)();g(e);const a=(0,o.useMemo)((()=>e),[e]),i=(0,o.useMemo)((()=>e=>(0,f.jsxs)("div",{className:"notification-container",style:{display:"block"},children:[(0,f.jsx)(m.A,{width:"20%"}),(0,f.jsx)(m.A,{}),(0,f.jsx)(m.A,{width:"60%"})]},e)),[]),l=(0,o.useMemo)((()=>e=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{children:e.title}),(0,f.jsx)("p",{children:e.message})]})),[]);return(0,f.jsx)("div",{className:"notifications",children:n?Array(3).fill(null).map(((e,n)=>i(n))):a.length>0?a.map(((e,n)=>(0,f.jsx)("div",{className:"notification-container",onClick:()=>(async e=>{const{handleNotificationClick:n}=await t.e(5231).then(t.bind(t,5231));n(e,s)})(e.title),children:l(e)},n))):(0,f.jsx)("div",{className:"notification-container",children:(0,f.jsx)("p",{children:"No notifications"})})})}const k=o.memo(j);var v=t(8810);function w(e){let{showSidebar:n,setMobileOpen:t,mobileOpen:a}=e;const l=(0,r.Zp)(),{notifications:m}=(0,o.useContext)(b),[g,j]=(0,o.useState)(null),w=Boolean(g),y=(0,o.useMemo)((()=>w?"notification-popover":void 0),[w]),A=(0,o.useMemo)((()=>(null===m||void 0===m?void 0:m.length)||0),[m]);return(0,f.jsxs)(c.A,{position:"fixed",sx:{width:{lg:n?"calc(100% - 60px)":"100%"},ml:{lg:"60px"},backgroundColor:"transparent",backgroundImage:"none",backdropFilter:"blur(6px) !important",boxShadow:"none"},children:[(0,f.jsxs)(i.A,{children:[(0,f.jsx)(d.A,{"aria-label":"open drawer",edge:"start",onClick:()=>t(!a),sx:{mr:2,display:{lg:"none"}},children:(0,f.jsx)(p.A,{})}),"/"!==window.location.pathname&&(0,f.jsx)(d.A,{"aria-label":"back",edge:"start",onClick:()=>l(-1),sx:{mr:1},children:(0,f.jsx)(h.A,{})}),(0,f.jsxs)("div",{style:{display:"flex",width:"100%",alignItems:"center"},children:[(0,f.jsx)("div",{style:{flex:1},children:(0,f.jsx)("img",{src:"/assets/images/logo.webp",alt:"logo",onClick:()=>l("/"),style:{cursor:"pointer",width:"120px",height:"60px"}})}),(0,f.jsx)(v.A,{badgeContent:A,color:"primary",children:(0,f.jsx)(x.A,{onClick:e=>{j(e.currentTarget)},sx:{cursor:"pointer"}})})]})]}),(0,f.jsx)(u.Ay,{id:y,open:w,anchorEl:g,onClose:()=>{j(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},container:document.querySelector(".App"),children:(0,f.jsx)(s.A,{sx:{p:0,minWidth:250,maxWidth:400},children:(0,f.jsx)(k,{})})})]})}const y=o.memo(w);var A=t(9694),S=t(685);const C=o.lazy((()=>t.e(7378).then(t.bind(t,7378))));function M(e){const n=(0,o.useMemo)((()=>({backgroundColor:"#111b21",backgroundImage:"url(/assets/images/sidebar-bg.webp)",backgroundAttachment:"fixed",backgroundPosition:"left 0 bottom 0 !important",backgroundSize:"250px !important",backgroundRepeat:"no-repeat",padding:"0 10px"})),[]),t=(0,o.useMemo)((()=>({"& .MuiDrawer-paper":{boxSizing:"border-box",width:60}})),[]);return(0,f.jsxs)(s.A,{component:"nav",sx:{width:{lg:60},flexShrink:{lg:0}},"aria-label":"mailbox folders",className:"sameer",children:[(0,f.jsx)(S.A,{PaperProps:{sx:n},variant:"temporary",open:e.mobileOpen,onOpen:()=>e.setMobileOpen(!e.mobileOpen),onClose:()=>e.setMobileOpen(!e.mobileOpen),ModalProps:{keepMounted:!0},sx:{...t,display:{xs:"block",lg:"none"}},children:(0,f.jsx)(o.Suspense,{fallback:(0,f.jsx)("div",{children:"Loading..."}),children:(0,f.jsx)(C,{})})}),(0,f.jsx)(A.Ay,{PaperProps:{sx:n},variant:"permanent",sx:{...t,display:{xs:"none",lg:"block"}},open:!0,children:(0,f.jsx)(C,{setRun:e.setRun})})]})}const O=o.memo(M);var L=t(3987),E=t(2436),N=t(3422),z=t(3785);const D=(0,N.io)("ws://localhost:9002",{transports:["websocket","polling"]});const P=function(e){const[n,t]=(0,o.useState)([]),[s,a]=(0,o.useState)(!0);return(0,o.useEffect)((()=>(async function(){try{const e=await(0,z.A)("/get-notifications");t(e.data)}catch(e){console.error(e),t([])}finally{a(!1)}}(),D.on("notification",(o=>{o.department===e.department&&o.rank<=e.rank&&t([o,...n])})),()=>{D.disconnect()})),[]),{notifications:n,setNotifications:t,loading:s,setLoading:a}};const B=function(){const[e,n]=(0,o.useState)([]);return(0,o.useEffect)((()=>{!async function(){try{const e=await z.A.get("/get-events");n(e.data)}catch(e){console.error(e)}}()}),[]),e};var H=t(5112),I=t(8312),R=t(5975),q=t(8222);var G=t(9435),V=t(6872);const F=o.lazy((()=>t.e(9321).then(t.bind(t,9321)))),T=o.lazy((()=>Promise.all([t.e(2993),t.e(4061)]).then(t.bind(t,4061)))),U=o.lazy((()=>t.e(3596).then(t.bind(t,3596)))),Z=o.lazy((()=>Promise.all([t.e(3036),t.e(5292)]).then(t.bind(t,5292))));function _(e){const[n,t]=(0,o.useState)(!1),[c,d]=(0,o.useState)(0),[p,h]=(0,o.useState)(!1),{user:x}=(0,o.useContext)(E.R),{theme:u}=(0,o.useContext)(H.D),{notifications:m,setNotifications:g,loading:j,setLoading:k}=P(x),v=B(),w=(0,o.useMemo)((()=>(0,L.A)(x)),[x]),A=(0,o.useMemo)((()=>({notifications:m,setNotifications:g,loading:j,setLoading:k})),[m,g,j,k]),S=(0,o.useMemo)((()=>({tabValue:c,setTabValue:d})),[c]),C=(0,o.useMemo)((()=>({flexGrow:1,width:{lg:"calc(100% - 60px)"},backgroundColor:"light"===u?"#F9FAFB":"#111B21",height:"100vh",overflow:"scroll",padding:0===v.length?"20px":"50px 20px",paddingTop:0})),[u,v.length]);return(0,o.useEffect)((()=>{(async e=>{try{const n=await(0,I.gf)(R.B,{vapidKey:"BLGKEfuaans2E5HO9H6OQOfLDoyrbx0Dl_XtcVLrUz-0LZvoNEvrO3tchAH8kZl_BleEDosVd-L684xbBCGn4GU"});n&&await(0,q.f)(n,e),(0,I.xD)(R.B,(async n=>{const t=await(0,I.gf)(R.B);t&&await(0,q.f)(t,e)}))}catch(n){console.error("Error setting up token refresh:",n)}})()}),[]),(0,f.jsx)(b.Provider,{value:A,children:(0,f.jsxs)(l.u.Provider,{value:S,children:[(0,f.jsx)(Z,{run:p,setRun:h}),(0,f.jsxs)(s.A,{sx:{display:"flex"},children:[(0,f.jsx)(a.Ay,{}),(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(y,{mobileOpen:n,setMobileOpen:t,showSidebar:e.showSidebar,setShowSidebar:e.setShowSidebar})}),e.showSidebar&&(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(O,{mobileOpen:n,setMobileOpen:t,setRun:h})}),(0,f.jsxs)(s.A,{component:"main",sx:C,children:[(0,f.jsx)(i.A,{}),(0,f.jsxs)(r.BV,{children:[w.map(((e,n)=>{let{path:t,element:s,allowedModules:a}=e;return(0,f.jsx)(r.qh,{path:t,element:0===a.length?s:(0,f.jsx)(o.Suspense,{fallback:(0,f.jsx)("div",{children:"Loading..."}),children:(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(F,{allowedModules:a,children:s})})})},n)})),(0,f.jsx)(r.qh,{path:"/not-authorized",element:(0,f.jsx)(o.Suspense,{fallback:(0,f.jsx)("div",{children:"Loading..."}),children:(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(T,{})})})}),(0,f.jsx)(r.qh,{path:"*",element:(0,f.jsx)(o.Suspense,{fallback:(0,f.jsx)("div",{children:"Loading..."}),children:(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(T,{})})})})]}),v.length>0&&(0,f.jsx)(o.Suspense,{fallback:(0,f.jsx)("div",{children:"Loading..."}),children:(0,f.jsx)(G.tH,{fallback:(0,f.jsx)(V.A,{}),children:(0,f.jsx)(U,{events:v})})})]})]})]})})}const K=o.memo(_)},8222:(e,n,t)=>{t.d(n,{f:()=>s});var o=t(3785);const s=async(e,n)=>{try{const t=await o.A.put("/save-fcm-token",{fcmToken:e});n&&n({open:!0,message:t.data.message,severity:"success"})}catch(a){var t,s;if(console.log(a),n)n({open:!0,message:"Network Error"===a.message?"Network Error, your details will be submitted when you are back online":(null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"An unexpected error occurred",severity:"error"})}}}}]);